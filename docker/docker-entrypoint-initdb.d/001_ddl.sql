-- Adminer 4.8.1 MySQL 8.0.32 dump (creazione iniziale db)

SET NAMES utf8;
SET time_zone = '+00:00';
SET foreign_key_checks = 0;
SET sql_mode = 'NO_AUTO_VALUE_ON_ZERO';

SET NAMES utf8mb4;

CREATE USER 'narpa'@'%' IDENTIFIED BY 'narpa';

CREATE DATABASE `narpa` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci */ /*!80016 DEFAULT ENCRYPTION='N' */;
USE `narpa`;

GRANT LOCK TABLES, DELETE, INSERT, SELECT, UPDATE ON `narpa`.* TO 'narpa'@'%';

CREATE TABLE IF NOT EXISTS `AUTORIZZAZIONE_RUOLO` (
  `RUOLO_ID` bigint NOT NULL,
  `FUNZIONE_CODICE` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  PRIMARY KEY (`RUOLO_ID`,`FUNZIONE_CODICE`),
  KEY `FUNZIONE_CODICE` (`FUNZIONE_CODICE`),
  CONSTRAINT `autorizzazione_ruolo_ibfk_1` FOREIGN KEY (`RUOLO_ID`) REFERENCES `RUOLO` (`ID`),
  CONSTRAINT `autorizzazione_ruolo_ibfk_2` FOREIGN KEY (`FUNZIONE_CODICE`) REFERENCES `FUNZIONE` (`CODICE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE IF NOT EXISTS  `AUTORIZZAZIONE_UTENTE` (
  `UTENTE_ID` bigint NOT NULL,
  `FUNZIONE_CODICE` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  PRIMARY KEY (`UTENTE_ID`,`FUNZIONE_CODICE`),
  KEY `FUNZIONE_CODICE` (`FUNZIONE_CODICE`),
  CONSTRAINT `autorizzazione_utente_ibfk_1` FOREIGN KEY (`UTENTE_ID`) REFERENCES `UTENTE` (`ID`),
  CONSTRAINT `autorizzazione_utente_ibfk_2` FOREIGN KEY (`FUNZIONE_CODICE`) REFERENCES `FUNZIONE` (`CODICE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE IF NOT EXISTS  `FUNZIONE` (
  `CODICE` varchar(20) COLLATE utf8mb4_general_ci NOT NULL,
  `DESCRIZIONE` varchar(128) COLLATE utf8mb4_general_ci NOT NULL,
  PRIMARY KEY (`CODICE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE IF NOT EXISTS  `PROFILO` (
  `ID` bigint NOT NULL AUTO_INCREMENT,
  `NOME` varchar(40) COLLATE utf8mb4_general_ci NOT NULL,
  `DESCRIZIONE` varchar(128) COLLATE utf8mb4_general_ci DEFAULT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE KEY `NOME` (`NOME`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE IF NOT EXISTS  `RUOLO` (
  `ID` bigint NOT NULL AUTO_INCREMENT,
  `NOME` varchar(50) COLLATE utf8mb4_general_ci NOT NULL,
  `DESCRIZIONE` varchar(50) COLLATE utf8mb4_general_ci NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE KEY `RUOLO_NOME_UK` (`NOME`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE IF NOT EXISTS  `RUOLO_PROFILO` (
  `PROFILO_ID` bigint NOT NULL,
  `RUOLO_ID` bigint NOT NULL,
  PRIMARY KEY (`PROFILO_ID`,`RUOLO_ID`),
  KEY `RUOLO_ID` (`RUOLO_ID`),
  CONSTRAINT `ruolo_profilo_ibfk_1` FOREIGN KEY (`PROFILO_ID`) REFERENCES `PROFILO` (`ID`),
  CONSTRAINT `ruolo_profilo_ibfk_2` FOREIGN KEY (`RUOLO_ID`) REFERENCES `RUOLO` (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE IF NOT EXISTS  `UTENTE` (
  `ID` bigint NOT NULL AUTO_INCREMENT,
  `USERNAME` varchar(25) COLLATE utf8mb4_general_ci NOT NULL,
  `PASSWORD` varchar(100) COLLATE utf8mb4_general_ci NOT NULL,
  `COGNOME` varchar(50) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `NOME` varchar(50) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `EMAIL` varchar(80) COLLATE utf8mb4_general_ci DEFAULT NULL,
  `PROFILO_ID` bigint DEFAULT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE KEY `UTENTE_USERNAME_UQ` (`USERNAME`),
  UNIQUE KEY `UTENTE_EMAIL_UQ` (`EMAIL`),
  KEY `PROFILO_ID` (`PROFILO_ID`),
  CONSTRAINT `utente_ibfk_1` FOREIGN KEY (`PROFILO_ID`) REFERENCES `PROFILO` (`ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


-- 2023-03-21 10:05:07
